<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Loterie</title>
    <style>
        /* Styles similaires à ceux de votre code original */
    </style>
</head>
<body>
    <h1>Loterie</h1>
    <button type="button" onclick="drawWinner()">Tirer au sort</button>
    <div id="winner" class="winner"></div>
    <form id="lotteryForm">
        <table>
            <thead>
                <tr>
                    <th>Numéro</th>
                    <th>Nom</th>
                    <th>Référence</th>
                </tr>
            </thead>
            <tbody id="numberInputs"></tbody>
        </table>
        <button type="button" onclick="promptPassword()">Réinitialiser</button>
    </form>

    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database.js"></script>
    <script>
        // Configuration Firebase
        const firebaseConfig = {
            apiKey: "VOTRE_API_KEY",
            authDomain: "VOTRE_AUTH_DOMAIN",
            databaseURL: "VOTRE_DATABASE_URL",
            projectId: "VOTRE_PROJECT_ID",
            storageBucket: "VOTRE_STORAGE_BUCKET",
            messagingSenderId: "VOTRE_MESSAGING_SENDER_ID",
            appId: "VOTRE_APP_ID"
        };
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        // Créer les champs de formulaire pour 100 numéros sous forme de tableau
        const numberInputs = document.getElementById('numberInputs');
        for (let i = 1; i <= 100; i++) {
            const row = document.createElement('tr');
            const cellNumber = document.createElement('td');
            cellNumber.innerText = i;
            const cellName = document.createElement('td');
            const inputName = document.createElement('input');
            inputName.type = 'text';
            inputName.placeholder = `Nom pour le numéro ${i}`;
            inputName.className = 'number-input';
            inputName.id = `number${i}`;
            inputName.addEventListener('input', () => {
                database.ref(`numbers/${i}`).set({
                    name: inputName.value,
                    reference: document.getElementById(`reference${i}`).value
                });
            });
            cellName.appendChild(inputName);

            const cellReference = document.createElement('td');
            const inputReference = document.createElement('input');
            inputReference.type = 'text';
            inputReference.placeholder = `Référence pour le numéro ${i}`;
            inputReference.className = 'reference-input';
            inputReference.id = `reference${i}`;
            inputReference.addEventListener('input', () => {
                database.ref(`numbers/${i}`).set({
                    name: document.getElementById(`number${i}`).value,
                    reference: inputReference.value
                });
            });
            cellReference.appendChild(inputReference);

            row.appendChild(cellNumber);
            row.appendChild(cellName);
            row.appendChild(cellReference);
            numberInputs.appendChild(row);

            // Charger les valeurs depuis Firebase
            database.ref(`numbers/${i}`).on('value', (snapshot) => {
                const data = snapshot.val();
                if (data) {
                    inputName.value = data.name || '';
                    inputReference.value = data.reference || '';
                }
            });
        }

        // Fonction pour tirer au sort un numéro gagnant
        function drawWinner() {
            const winnerIndex = Math.floor(Math.random() * 100) + 1;
            const winnerName = document.getElementById(`number${winnerIndex}`).value;
            document.getElementById('winner').innerText = `Le numéro gagnant est ${winnerIndex} (${winnerName})`;
        }

        // Fonction pour demander le mot de passe avant de réinitialiser le formulaire
        function promptPassword() {
            const password = prompt("Veuillez entrer le mot de passe pour réinitialiser:");
            if (password === "admin") {
                resetForm();
            } else {
                alert("Mot de passe incorrect.");
            }
        }

        // Fonction pour réinitialiser le formulaire
        function resetForm() {
            for (let i = 1; i <= 100; i++) {
                document.getElementById(`number${i}`).value = '';
                document.getElementById(`reference${i}`).value = '';
                database.ref(`numbers/${i}`).remove();
            }
            document.getElementById('winner').innerText = '';
        }
    </script>
</body>
</html>
